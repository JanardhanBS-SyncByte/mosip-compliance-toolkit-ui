<h2 mat-dialog-title class="mat-dialog-title">
    <div class="custom-class">
        Executing Test Run
        <span class="spacer"></span>
        <mat-icon [ngStyle]="{color: '#fd518c'}">timelapse</mat-icon>
        <cd-timer #basicTimer format="hms"></cd-timer>
    </div>
</h2>
<mat-dialog-content style="white-space: pre-line;" class="run-container">
    <span *ngIf="!scanComplete  && validationErrMsg == ''">
        <span class="custom-class" [ngStyle]="{color: 'red'}">
            <p>
                <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon>No device selected. Please scan device
                first.
            </p>
        </span>
    </span>
    <span *ngIf="!scanComplete && validationErrMsg != ''">
        <span class="custom-class" [ngStyle]="{color: 'red'}">
            <p>
                <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon>{{validationErrMsg}}
            </p>
        </span>
    </span>
    <span *ngIf="scanComplete">
        <span *ngIf="!dataLoaded">
            <span *ngIf="!errorsInGettingTestcases">Fetching testcases for the collection..</span>
            <div class="spinner">
                <mat-spinner diameter="50"></mat-spinner>
            </div>
        </span>
        <span *ngIf="dataLoaded">
            <span *ngIf="errorsInGettingTestcases" class="custom-class">
                <p>
                    <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon>Unable to get testcases for the collection.
                </p>
            </span>
            <span *ngIf="!errorsInGettingTestcases">
                <span *ngIf="!runComplete">
                    Execution of testcases for collection <b>{{collectionName}}</b> has started.
                    <p></p>Current testcase: <h2>{{currectTestCaseId}} - {{currectTestCaseName}}</h2>
                    <i>{{currentTestDescription}}</i>
                    <div *ngIf="!showInitiateCaptureBtn" class="spinner">
                        <mat-spinner diameter="50"></mat-spinner>
                    </div>
                    <div *ngIf="showInitiateCaptureBtn">
                        <p></p><span [ngStyle]="{color: '#fd518c'}">Please click on initiate capture to capture the biometrics
                            from the
                            device..</span>
                    </div>
                </span>
                <span *ngIf="runComplete">
                    <div *ngIf="serviceErrors">
                        <div class="custom-class">
                            <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon>
                            <span [ngStyle]="{color: 'red'}">
                                There were errors while processing the service.
                            </span>
                            <span class="spacer"></span>
                        </div>
                        <p> <span [ngStyle]="{color: 'red'}">
                                <span *ngFor="let item of errorsSummary">
                                    {{item}}<br />
                                </span>
                            </span></p>
                    </div>
                    <div *ngIf="errorsInSavingTestRun">
                        <div class="custom-class">
                            <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon>
                            <span [ngStyle]="{color: 'red'}">
                                Unable to save / update test run details. Please try again.
                            </span>
                            <span class="spacer"></span>
                        </div>
                    </div>
                    <div *ngIf="!serviceErrors && !errorsInSavingTestRun">
                        <p>Total {{testCasesList.length > 1 ? testCasesList.length + ' testcases have' :
                            testCasesList.length + ' testcase has'}} executed successfully.
                            Overall result for testcases:</p>
                        <div class="custom-class">
                            <p>
                                <mat-icon [ngStyle]="{color: 'green'}">check_circle</mat-icon>
                                {{countOfSuccessTestcases}} have
                                passed.
                            </p>
                        </div>
                        <div class="custom-class">
                            <p>
                                <mat-icon [ngStyle]="{color: 'red'}">clear</mat-icon> {{countOfFailedTestcases}} have
                                failed.
                            </p>
                        </div>
                        <p>
                            For a detailed report <a class="link" (click)="viewTestRun()">click here</a>.
                        </p>
                    </div>
                </span>
            </span>
        </span>
    </span>
</mat-dialog-content>
<mat-dialog-actions align="end">
    <button *ngIf="!scanComplete || (scanComplete && errorsInGettingTestcases) 
        || (scanComplete && !errorsInGettingTestcases && runComplete)" mat-flat-button color="accent"
        (click)="close()">Close</button>
    <div class="spacer"
        *ngIf="(scanComplete && !errorsInGettingTestcases && !runComplete && showInitiateCaptureBtn) || (scanComplete && !errorsInGettingTestcases && runComplete && !serviceErrors && !errorsInSavingTestRun)">
    </div>
    <button *ngIf="scanComplete && !errorsInGettingTestcases && !runComplete && showInitiateCaptureBtn" mat-flat-button
        color="accent" (click)="setInitiateCapture()">Initiate Capture</button>
    <button *ngIf="scanComplete && !errorsInGettingTestcases && runComplete && !serviceErrors && !errorsInSavingTestRun"
        mat-flat-button color="accent" (click)="viewTestRun()">View Test Run</button>
    <!-- <div *ngIf="scanComplete">
        <div *ngIf="errorsInGettingTestcases">
            <button mat-flat-button color="accent" (click)="close()">Close</button>
        </div>
        <div *ngIf="!errorsInGettingTestcases">
            <div *ngIf="!runComplete">
                <div *ngIf="showInitiateCaptureBtn"  class="custom-class">
                    <button mat-flat-button color="accent" (click)="close()">Close</button>
                    <div class="spacer"></div>&nbsp;&nbsp;
                    <button mat-flat-button color="accent" (click)="setInitiateCapture()">Initiate Capture</button>
                </div>
            </div>
            <div *ngIf="runComplete">
                <div *ngIf="!serviceErrors && !errorsInSavingTestRun"  class="custom-class">
                    <button mat-flat-button color="accent" (click)="close()">Close</button>
                    <div class="spacer"></div>&nbsp;&nbsp;
                    <button mat-flat-button color="accent" (click)="viewTestRun()">View Test Run</button>                                
                </div>
                <div *ngIf="serviceErrors || errorsInSavingTestRun">
                    <button mat-flat-button color="accent" (click)="close()">Close</button>
                </div>
            </div>    
        </div>
    </div> -->
</mat-dialog-actions>